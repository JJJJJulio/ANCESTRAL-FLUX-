<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ANCESTRAL FLUX — Web</title>
  <link rel="stylesheet" href="styles.css" />
  <script>
    // Carga robusta de p5.js con fallback para evitar pantalla negra si falla un CDN.
    (function () {
      function loadScript(src, onOk, onErr) {
        const s = document.createElement('script');
        s.src = src;
        s.onload = onOk;
        s.onerror = onErr;
        document.head.appendChild(s);
      }

      function loadSketch() {
        const sketch = document.createElement('script');
        sketch.src = 'web-sketch.js';
        sketch.defer = true;
        document.head.appendChild(sketch);

        window.setTimeout(() => {
          if (!window.__AF_SKETCH_READY__) {
            const node = document.getElementById('status-readout');
            if (node) node.textContent = 'No se pudo iniciar el render. Revisa conexión/CDN.';
          }
        }, 4200);
      }

      loadScript(
        'https://cdn.jsdelivr.net/npm/p5@1.9.4/lib/p5.min.js',
        loadSketch,
        () => loadScript('https://unpkg.com/p5@1.9.4/lib/p5.min.js', loadSketch, () => {
          const node = document.getElementById('status-readout');
          if (node) node.textContent = 'Error cargando p5.js desde ambos CDNs.';
        })
      );
    })();
  </script>
</head>
<body>
  <aside class="ui" id="overlay-ui" aria-label="Panel de comandos">
    <h1>ANCESTRAL FLUX</h1>
    <p>Mouse: move → flow</p>
    <p>Click → vortex</p>

    <ul>
      <li><kbd>1-5</kbd> modos</li>
      <li><kbd>P</kbd> palette</li>
      <li><kbd>V</kbd> lines</li>
      <li><kbd>G</kbd> glow</li>
      <li><kbd>T</kbd> trails</li>
      <li><kbd>C</kbd> palette shift</li>
      <li><kbd>R</kbd> reseed</li>
      <li><kbd>H</kbd> hide/show UI</li>
    </ul>

    <p class="status" id="status-readout" aria-live="polite"></p>
  </aside>
</body>
</html>
